
clear all; clc; close all;

% Set working directories.
rootDir = '/N/dc2/projects/lifebid/development/sosdenoising/';

%% Single-subject Training
figure(1)
% Sub-001
image1 = [2.51445e+06 2.42114e+06 2.41276e+06 2.40896e+06 2.40723e+06 2.40257e+06 2.3993e+06 2.3953e+06 2.38922e+06 2.38627e+06 2.38264e+06 2.38039e+06 2.37817e+06 2.37595e+06 2.37337e+06 2.37151e+06 2.36998e+06 2.36837e+06 2.36763e+06 2.3662e+06 2.36469e+06];
plot(linspace(1, length(image1), length(image1))*5, image1, 'r')
hold on;
% Sub-002
image2 = [1.63109e+06 1.61341e+06 799078 797800 797098 796904 796788 796702 796674 796579 796579 796518 796490 796471 796454 796429 796422 796397 796381 796374 796365];
plot(linspace(1, length(image2), length(image2))*5, image2, 'g')
% Sub-003
image3 = [2.63333e+06 1.34833e+06 1.33959e+06 1.33762e+06 1.33691e+06 1.33644e+06 1.33613e+06 1.33584e+06 1.33566e+06 1.33543e+06 1.33516e+06 1.33493e+06 1.33478e+06 1.3347e+06 1.33469e+06 1.33456e+06 1.33449e+06 1.33434e+06 1.33426e+06 1.3342e+06 1.3342e+06];
plot(linspace(1, length(image3), length(image3))*5, image3, 'b')
% Sub-004
image4 = [1.34972e+06 491551 98348.1 86025.9 79832.5 76374.4 74735 74107 72401.2 73391 73076.5 72331.2 72354 72139 71943 71881.7 71658.9 71751.1 71559.2 71599.2 71652.1];
plot(linspace(1, length(image4), length(image4))*5, image4, 'k')

ylabel('Loss (MSE)'); xlabel('Iteration');
title({'Single-subject Training,'; '100 iterations'})
legend({'sub-001', 'sub-002', 'sub-003', 'sub-004'});
legend box off
pbaspect([1 1 1])
box off
print(fullfile(rootDir, 'plots', 'plot_loss_iter100_singleSubTraining'), '-dpng')
hold off;

%% Multi-subject Training - split-half

figure(2)
% Sub-001002
image1 = [545064 409710 397946 394838 392752 390865 390608 390219 383307 383181 383204 383154 376194 376232 376388 376714 376923 377155 377408 377647 377686 ...
28310.8 20300.6 18211.4 17128.7 16589.1 16248.7 16047 15898.2 15788.5 15705.5 15645.9 15595.3 15548.3 15512.4 15479.8 15445.8 15419.4 15396.1 15388 15373.9 15361.2];
plot(linspace(1, length(image1), length(image1))*5, image1, 'r')
hold on;
% Sub-001003
image2 = [929471 891994 876938 873633 871190 870280 869264 744328 743772 612220 612164 610813 610912 611093 609788 609789 609718 609606 609372 609212 609065 ...
128750 115631 113525 112147 111223 110615 110206 109929 109729 109573 109448 109345 109259 109186 109119 109059 109003 108958 108911 108867 108826];
plot(linspace(1, length(image2), length(image2))*5, image2, 'g')
% Sub-001004
image3 = [704758 673379 666454 657657 649541 648514 639965 505847 505310 498026 497929 497730 497647 489648 489317 489259 488346 488059 480587 480758 480774 ...
83043 67660.8 64676.3 63155.5 62350.8 61870.2 61487.4 61232.9 61048.7 60926.3 60844.2 60795.9 60770.1 60743.3 60720.2 60699.6 60668.2 60642.8 60613.1 60583.4 60566.6];
plot(linspace(1, length(image3), length(image3))*5, image3, 'b')
% Sub-002003
image4 = [226749 185493 183779 182963 182496 182233 182079 182067 182001 181950 181910 181888 181878 181856 181839 181822 181806 181794 181781 181768 181760 ...
268674 268369 268300 268258 268216 268180 268158 268135 268119 268104 268092 268076 268047 266469 266405 266355 266312 266276 175369 175123 175034];
plot(linspace(1, length(image4), length(image4))*5, image4, 'k')
% Sub-002004
image5 = [92799.2 46038.4 43909 33174.6 32634.7 32361.2 32204 32113.8 32051.1 32001.8 31962.7 31930.6 31902.5 31881.5 31863 31846.5 31831.1 31815.7 31803.2 31791.3 31779.5 ...
22223.5 22210.7 22112.6 22023.5 21960.8 21920.5 21897.5 21890.8 21888.3 21893.3 21896.9 21895.5 21900.5 21898.4 21895.5 21887.3 21877.8 21869.7 21864.7 21852.9 21845.9];
plot(linspace(1, length(image5), length(image5))*5, image5, 'c')
% Sub-003004
image6 = [290241 251476 249256 151096 147560 146622 145907 145385 145022 144772 144596 144473 144372 144295 144236 144188 144142 144091 144053 144020 143991 ...
90137.4 32640.9 32235.4 32065.8 31972.9 31918.9 31886.7 31866.4 31849.8 31835 31825.4 31815.6 31805.7 31794 31783.9 31774.4 31764.1 31753.4 31739.8 31726.6 31713.8];
plot(linspace(1, length(image6), length(image6))*5, image6, 'y')

ylabel('Loss (MSE)'); xlabel('Iteration');
title({'Multi-subject Training, split-half'; '100 iterations'})
legend({'sub-001002', 'sub-001003', 'sub-001004', 'sub-002003', 'sub-002004', 'sub-003004'});
legend box off
pbaspect([1 1 1])
box off
print(fullfile(rootDir, 'plots', 'plot_loss_multiSubTraining_iter100_splithalf'), '-dpng')
hold off;

%% Multi-subject Training - leave-one-out

figure(3)
% Sub-001002003
image1 = [423300 398159 385600 380089 376410 374761 373815 372517 372114 372078 372264 372425 373084 373676 374177 374529 374836 375045 375293 375279 375328 ...
28369.2 20688.4 10222.2 8911.45 8316.44 7999.19 7802.78 7669.62 7579.02 7508.14 7449.59 7403.68 7364.02 7326.73 7296.14 7273.96 7253.66 7232.23 7211.13 7193.21 7187.11 ...
11943.1 11522.1 11411.1 11305.3 11214.8 11141.9 11075.6 11011.4 10956.6 10903.2 10857.1 10814.7 10772.6 10734.7 10700.7 10669.1 10638 10608.2 10580.1 10550.9 10524];
plot(linspace(1, length(image1), length(image1))*5, image1, 'r')
hold on;
% Sub-002003004
image2 = [249975 223835 222556 137736 135191 133491 124430 124257 124147 124077 124026 68337.3 67993.5 67945.3 67909.8 67881.2 66687.7 66650 66626.3 66608.4 66594.8 ...
90892.8 90842.5 90763.4 90682.8 90617.6 90553.2 90498.6 90444.5 90392.5 90351.2 90307.9 90267 90226.2 79052.3 78996.7 78943.1 78902.4 67281 67242.1 67216 67200.9 ...
29428.4 28377.9 27939.2 27762.3 27704.5 27683.7 27673.5 27668.1 27664.9 27663.5 27662.1 27660 27660.4 27661.2 27659.9 27655.8 27652.5 27650.3 27646.7 27644 27639.3];
plot(linspace(1, length(image2), length(image2))*5, image2, 'g')
%Sub-003004001
image3 = [363864 322942 320493 319244 318422 317882 317480 306133 304364 304134 303955 303812 303697 303601 303517 303447 301560 301481 301421 301375 299570 ...
167032 165314 163970 163794 157493 157366 157291 157241 157188 157130 102563 102337 102225 102145 102090 102053 102032 102012 101995 101986 101976 ...
521564 522877 522804 522456 522760 522507 522189 521959 521829 522084 522260 522442 515323 513885 508829 508867 509112 509714 510474 511279 511824];
plot(linspace(1, length(image3), length(image3))*5, image3, 'b')
% Sub-004001002
image4 = [139844 97689.2 95161.8 92975.2 92128.4 91598.4 91247.1 91001.1 90816.9 90685.6 90573 90480.1 89478.3 89383.5 38739.4 38342.5 38126.2 38004.6 37933.8 37879.5 37838 ...
401371 402229 401562 393484 392391 392283 392495 392648 393092 393447 393778 393992 394284 394456 394689 395297 395785 396271 396668 397155 390630 ...
39333.3 32107 29916.9 28807.3 28160.4 27832.7 27647 27532.9 27454.3 27396.7 27361.6 27324.2 27295.2 27268.3 27246.6 27230.1 27218.9 27207.3 27199.2 27191.4 27183.7];
plot(linspace(1, length(image4), length(image4))*5, image4, 'k')

ylabel('Loss (MSE)'); xlabel('Iteration');
title({'Multi-subject Training, leave-one-out'; '100 iterations'})
legend({'sub-001002003', 'sub-002003004', 'sub-003004001', 'sub-004001002'});
legend box off
pbaspect([1 1 1])
box off
print(fullfile(rootDir, 'plots', 'plot_loss_multiSubTraining_iter100_leaveoneout'), '-dpng')
hold off;

%% Multi-subject Training - leave-oneout - 200 Iterations
figure(4)
% Sub-001002003
image1 = [426302 410799 405174 401231 393106 385678 378141 377464 377563 377943 371584 371895 372218 372642 372833 372804 372899 372956 372963 373137 373561 ...
27147.6 13237.4 10008.4 8849.62 8368.83 8106.07 7920.05 7783.5 7681.87 7597.11 7535.58 7490.76 7455.58 7428.42 7408.88 7394.61 7384.85 7375.95 7370.47 7367.28 7366.69 ...
11624.4 11142.7 10958.7 10826.8 10726.6 10645 10577.5 10519.2 10466.8 10418.4 10372.7 10326.7 10280.9 10374.6 10192 10605.5 10116.2 10079.2 10044.7 10009 9974.99];
plot(linspace(1, length(image1), length(image1))*5, image1, 'r')
hold on;
% Sub-002003004
image2 = [117826 66200.1 55833 55342 55165.7 46497.4 46391.7 46339.6 46304.4 45050.8 45005.6 44979.2 44958.5 44944.8 44932.4 36182.7 36139.6 36123.1 36112 36103.5 36096.4 ...
51706.9 51601.4 51471.8 51367.2 51297.1 51216.9 51137.1 51090.7 51049.2 51007.8 50979.1 50953.7 50938.3 50923.4 50904.4 50894.8 50884.5 50867.6 50857 50842.4 50832.1 ...
25860.7 24847 24710.6 24688.8 24684.4 24682.6 24680.2 23858.1 23837.5 23832.5 23827.7 23822.1 23809.2 23797.9 23787.2 23779.3 23769.4 23761.5 23756.8 23753.9 23761.5];
plot(linspace(1, length(image2), length(image2))*5, image2, 'g')
% Sub-003004001
image3 = [96839.2 35928.7 33795.6 29036.9 28379.1 27925.9 27619.4 27427 27305.2 27220.4 27158.3 27103.2 27052.2 27008.5 25314.1 25271.6 25237.6 25209.1 25171.9 25131.9 25085.6 ...
19513.2 18348.3 18159.3 18123.2 17164.8 16181 16157.4 16131.1 16094.9 16058.2 16025.2 15993.9 15968.2 15944 15918.5 15895 15872.4 15851.8 15831.1 15816.9 15804.3 ...
369149 375621 373132 370348 370465 370000 370798 371045 371452 371912 372028 372033 371872 371830 371733 371371 371388 371380 371609 372360 373448];
plot(linspace(1, length(image3), length(image3))*5, image3, 'b')
% Sub-004001002
image4 = [343940 242083 171181 49590.1 47066.8 46490.2 46111.2 45901.3 45803.6 39440.1 39334.6 39298.2 39280.6 39265 39246.1 39224.7 39203.7 39184.3 39162.9 39144.8 39121.4 ...
402431 402396 399986 397808 399241 398968 399590 400067 400524 400975 400453 401274 402166 403129 403676 404283 404836 405436 406422 407548 409224 ...
63146.3 47583.5 45145.3 44219.1 43784 43541.1 43364.3 43250.1 43187.9 43141 43106.2 43057.2 42995.9 42965.4 42950.2 42955.2 42964.8 42968.3 42973.3 42979.1 42980.9];
plot(linspace(1, length(image4), length(image4))*5, image4, 'k')

ylabel('Loss (MSE)'); xlabel('Iteration');
title({'Multi-subject Training, leave-one-out'; '200 iterations'})
legend({'sub-001002003', 'sub-002003004', 'sub-003004001', 'sub-004001002'});
legend box off
pbaspect([1 1 1])
box off
print(fullfile(rootDir, 'plots', 'plot_loss_multiSubTraining_iter200_leaveoneout'), '-dpng')
hold off;

%% Multi-subject Training - leave-oneout - 50 Iterations

figure(5)
% Sub-001002003
image1 = [529348 513182 504194 503005 501425 498466 495443 493519 491539 490410 489368 488424 487644 486996 486387 485885 485363 484937 484510 484202 483932 483708 483530 483310 483204 483041 ...
78172.8 73252.3 71964.5 70983 70150.5 69643.6 69086.7 68673.1 68394.3 68185.1 68035.4 67925.2 67832.5 67756.9 67691.5 67631.9 67581.5 67540.2 67503.2 67470.3 67441.2 67415.3 67390.7 67368.7 67349.5 67331.2 ...
107976 107863 107788 107754 107729 107703 107675 107648 107622 107597 107573 107550 107531 107514 107496 107478 107462 107447 107431 107415 107401 107388 107374 107361 107349 107336];
plot(linspace(1, length(image1), length(image1))*5, image1, 'r')
hold on;
% Sub-002003004
image2 = [394941 288074 266208 265129 264322 263642 263128 262715 262388 262140 261950 261802 261687 261596 261516 261452 261401 261357 261319 261285 261255 261228 261204 261182 261163 261146 ...
420539 420645 420528 420455 420405 420365 420330 420300 420272 420247 420223 420203 420183 420165 420147 420130 420114 420098 420083 420071 420057 420045 420034 420022 420010 420000 ...
245615 245332 245125 244964 244852 244777 244725 244686 244658 244636 244619 244606 244594 244585 244576 244569 244561 244553 244547 244541 244537 244531 244526 244519 244514 244508];
plot(linspace(1, length(image2), length(image2))*5, image2, 'g')
% Sub-003004001
image3 = [321751 264898 177298 173598 160235 159189 158262 157429 156784 156199 155671 155212 154842 154551 154310 154095 153904 153737 153592 153466 153353 153254 153165 153087 153018 152955 ...
88678.9 88179.8 87819.9 87541.6 87345.4 87209.2 87112.8 87040.3 86987.3 86944.2 86910.1 86882.2 86858.2 86837 86819.3 86803.9 86788.6 86774.4 80908.3 80763.7 80721.4 80686.8 80657.1 80630.7 80609.6 80592 ...
375855 372860 373070 371952 368519 370199 370307 370216 370018 369743 369497 369265 369022 368778 368553 368373 368287 368111 368004 367954 367954 367922 367939 367956 367915 367845];
plot(linspace(1, length(image3), length(image3))*5, image3, 'b')
% Sub-004001002
image4 = [325851 229086 166243 163987 162788 161035 160362 159835 159391 159017 158701 158431 158195 157989 157807 157644 157493 157357 157226 157104 156986 156873 150727 150609 150503 150405 ...
654739 654354 653855 653474 653011 652547 652113 644576 644249 643956 643624 636348 629253 504654 503106 502832 502584 502393 502149 501892 501656 501414 501201 501019 500815 500803 ...
83108 78928.5 76369.5 75275 74627.1 74014.4 72240.8 71946.8 71764.8 71630.2 71535.5 71455.6 71387.5 71336 71291.8 71255 71221.5 71190.5 71162.3 71138.4 71118.4 71100.6 71084.4 71068.3 71054.8 71042.3];
plot(linspace(1, length(image4), length(image4))*5, image4, 'k')

ylabel('Loss (MSE)'); xlabel('Iteration');
title({'Multi-subject Training, leave-one-out'; '50 iterations'})
legend({'sub-001002003', 'sub-002003004', 'sub-003004001', 'sub-004001002'});
legend box off
pbaspect([1 1 1])
box off
print(fullfile(rootDir, 'plots', 'plot_loss_multiSubTraining_iter50_leaveoneout'), '-dpng')
hold off;
